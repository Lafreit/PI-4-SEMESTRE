{% extends "base.html" %}
{% load static %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'perfil.css' %}">
{% endblock %}

{% block content %}
<div class="dashboard-container">

    <nav class="top-navbar" id="mainNavbar">
        <div class="logo-area">Carona F√°cil</div>
        <div class="menu">
            <a href="{% url 'usuarios:pagina_inicial' %}" class="menu-item">In√≠cio</a>
            <a href="{% url 'usuarios:meu_perfil' %}" class="menu-item active">Meu Perfil</a>
            <a href="{% url 'corrida:lista_corridas' %}" class="menu-item">Minhas Viagens</a>
            <a href="#" class="menu-item">Central de Ajuda</a>
        </div>

        <div class="user-and-logout">
            <div class="user-info-navbar">
                <img src="{% static 'img/imgusu.png' %}" alt="Usu√°rio" class="user-avatar-small">
                <span>{{ user.nome }}</span>
            </div>
            <a href="{% url 'usuarios:logout' %}" class="action-btn logout-btn btn-danger">Sair</a>
        </div>
    </nav>

    <main class="main-content">

        <button onclick="toggleDarkMode()" class="action-btn mode-toggle-btn">
            üåô
        </button>

        <div class="header-banner">
            <h1>Meu Perfil Motorista üöó</h1>
            <p>Gerencie seus dados de motorista, documentos e desempenho.</p>
        </div>

        {% if messages %}
            <div class="message-container" style="margin-bottom: 25px; margin-top: 15px;">
                {% for message in messages %}
                    <div class="notification-banner {% if message.tags == 'success' %}success-message{% elif message.tags == 'error' %}error-message{% endif %}"
                            role="alert" style="padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                        <span style="margin-right: 10px; font-size: 1.2em;">
                            {% if message.tags == 'success' %}‚úÖ{% elif message.tags == 'error' %}‚ùå{% endif %}
                        </span>
                        {{ message }}
                    </div>
                {% endfor %}
            </div>
        {% endif %}

        <div class="profile-cards-grid">

            <section class="action-card profile-info-card">
                <h3>Dados Pessoais</h3>
                <p><strong>Nome:</strong> {{ user.nome }}</p>
                <p><strong>Email:</strong> {{ user.email }}</p>
                <p><strong>Tipo de Usu√°rio:</strong> Motorista</p>
                <a href="{% url 'usuarios:editar_perfil' %}" class="action-btn">Editar Dados</a>
            </section>

            <section class="action-card vehicle-info-card">
                <h3>Informa√ß√µes do Ve√≠culo</h3>
                <p><strong>Modelo:</strong> {{ user.profile_data.modelo_veiculo|default:"N√£o Cadastrado" }}</p>
                <p><strong>Placa:</strong> {{ user.profile_data.placa|default:"N/A" }}</p>
                <p><strong>CPF:</strong> {{ user.profile_data.cpf|default:"N/A" }}</p>
                <p><strong>Status de Aprova√ß√£o:</strong> <span class="status approved" style="color: var(--accent-green); font-weight: 700;">Aprovado</span></p>
                <a href="{% url 'usuarios:atualizar_veiculo' %}" class="action-btn secondary-btn" style="background-color: var(--text-secondary); box-shadow: none;">Atualizar Ve√≠culo</a>
            </section>

            <section class="action-card plans-card">
                <h3>Planos Dispon√≠veis üíé</h3>
                <div class="plan-item" style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                    <span>Plano Motorista Pro</span>
                    <span class="plan-status active" style="color: var(--accent-green); font-weight: 600;">Ativo</span>
                </div>
                <div class="plan-item" style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                    <span>Plano VIP Completo</span>
                    <span class="plan-status upgrade" style="color: var(--primary-blue); font-weight: 600;">Fazer Upgrade</span>
                </div>
                <p style="margin-top:15px; color: var(--text-secondary);">Seu plano atual garante taxas reduzidas e suporte priorit√°rio.</p>
                <button class="action-btn secondary-btn" style="background-color: var(--text-secondary); box-shadow: none;">Gerenciar Assinatura</button>
            </section>

            <section class="action-card performance-card">
                <h3>Desempenho üìä</h3>
                <p><strong>Avalia√ß√£o m√©dia:</strong> 4.9 ‚≠ê</p>
                <p><strong>Corridas conclu√≠das:</strong> 420</p>
                <p><strong>Avalia√ß√µes 5 estrelas:</strong> 95%</p>
                <a href="#" class="link-details" style="color: var(--primary-blue); font-weight: 600;">Ver Detalhes</a>
            </section>

            <section class="action-card documents-card">
                <h3>Documentos</h3>
                <p>CNH e CRLV devem estar v√°lidos para realizar corridas.</p>
                <p>Pr√≥xima verifica√ß√£o: 10/12/2025</p>
                <button class="action-btn primary-btn">Ver Documentos</button>
            </section>

            <section class="action-card help-center-card">
                <h3>Central de Ajuda ‚ùì</h3>
                <p>Precisa de suporte? Encontre respostas e envie feedback.</p>
                <p>Atendimento 24h / 7 dias por semana.</p>
                <a href="#" class="action-btn">Acessar Suporte</a>
            </section>
        </div>
    </main>
</div>
{% endblock %}

{% block scripts %}
<script>
function toggleDarkMode() {
    document.body.classList.toggle("dark-mode");
    localStorage.setItem("darkMode", document.body.classList.contains("dark-mode"));
    // Usa a classe CSS correta do bot√£o
    const btn = document.querySelector('.mode-toggle-btn');
    if (btn) {
        btn.textContent = document.body.classList.contains("dark-mode") ? '‚òÄÔ∏è' : 'üåô';
    }
}

window.onload = function() {
    // Verifica modo escuro
    if (localStorage.getItem("darkMode") === "true") {
        document.body.classList.add("dark-mode");
    }

    // Atualiza √≠cone do bot√£o com a classe correta
    const btn = document.querySelector('.mode-toggle-btn');
    if (btn) {
        btn.textContent = document.body.classList.contains("dark-mode") ? '‚òÄÔ∏è' : 'üåô';
    }



    const header = document.querySelector('.header-banner');
    if (header) {
        // Remove os estilos CSS inline desnecess√°rios se o .header-banner j√° estiver formatado pelo CSS
        // Apenas para garantir que a imagem do motorista seja usada, se for diferente da de passageiro:
        header.style.backgroundImage = `
            linear-gradient(rgba(0, 0, 0, 0.55), rgba(0, 0, 0, 0.55)),
            url('{% static 'img/perfilp.png' %}')
        `; // Mantenho a imagem original do primeiro c√≥digo
    }
};
</script>
{% endblock %}
