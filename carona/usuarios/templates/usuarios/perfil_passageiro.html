{% extends "base.html" %}
{% load static %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'perfil.css' %}">
{% endblock %}

{% block content %}
<div class="dashboard-container">

  <nav class="top-navbar" id="mainNavbar">
    <div class="logo-area">Carona FÃ¡cil</div>
    <div class="menu">
      <a href="{% url 'usuarios:pagina_inicial' %}" class="menu-item">InÃ­cio</a>
      <a href="{% url 'usuarios:meu_perfil' %}" class="menu-item active">Meu Perfil</a>
      <a href="{% url 'corrida:lista_corridas' %}" class="menu-item">Minhas Viagens</a>
      <a href="#" class="menu-item">Central de Ajuda</a>
    </div>
    <div class="user-and-logout">
      <div class="user-info-navbar">
        <img src="{% static 'img/imgusu.png' %}" alt="UsuÃ¡rio" class="user-avatar-small">
        <span>{{ user.nome }}</span>
      </div>
      <a href="{% url 'usuarios:logout' %}" class="action-btn logout-btn btn-danger" >Sair</a>
    </div>
  </nav>

  <main class="main-content">
    <button onclick="toggleDarkMode()" class="action-btn mode-toggle-btn">ğŸŒ™</button>

    <!-- HEADER -->
    <div class="header-banner">
      <h1>Meu Perfil</h1>
      <p>Gerencie seus dados pessoais, pagamentos e planos de fidelidade.</p>
    </div>

    <div class="profile-cards-grid">
      <section class="action-card profile-info-card">
        <h3>Dados Pessoais</h3>
        <p><strong>Nome:</strong> {{ user.nome }}</p>
        <p><strong>Email:</strong> {{ user.email }}</p>
        <p><strong>Tipo de UsuÃ¡rio:</strong> Passageiro</p>
        <a href="{% url 'usuarios:editar_perfil' %}" class="action-btn">Editar Dados</a>
      </section>

      <section class="action-card plans-card">
        <h3>Planos DisponÃ­veis ğŸ’</h3>
        <div class="plan-item">
          <span>Plano VIP (Anual)</span>
          <span class="plan-status active">Ativo</span>
        </div>
        <div class="plan-item">
          <span>Plano FamÃ­lia</span>
          <span class="plan-status upgrade">Fazer Upgrade</span>
        </div>
        <p style="margin-top:15px;">Seu plano atual garante 10% de desconto em todas as corridas.</p>
        <button class="action-btn">Gerenciar Assinatura</button>
      </section>

      <section class="action-card trips-card">
        <h3>Ãšltimas Viagens ğŸ—ºï¸</h3>
        <p>Destino mais recente: Rua das Flores, 123</p>
        <p>Motorista: Lucas F. (4.8 estrelas)</p>
        <p>Data: 01/05/2025</p>
        <a href="#" class="link-details">Ver HistÃ³rico Completo</a>
      </section>

      <section class="action-card payment-info-card">
        <h3>MÃ©todos de Pagamento</h3>
        <p>CartÃ£o cadastrado: VISA final 4321</p>
        <p>Pix: Chave CPF cadastrada</p>
        <button class="action-btn">Gerenciar Pagamentos</button>
      </section>

      <section class="action-card favorites-card">
        <h3>Motoristas Favoritos</h3>
        <p>VocÃª tem 5 motoristas marcados como favoritos.</p>
        <a href="#" class="link-details">Ver Lista</a>
      </section>

      <section class="action-card help-center-card">
        <h3>Central de Ajuda â“</h3>
        <p>Encontre respostas rÃ¡pidas, envie feedback ou reporte um problema.</p>
        <p>HorÃ¡rio de Atendimento: 24/7</p>
        <a href="#" class="action-btn">Acessar Suporte</a>
      </section>
    </div>
  </main>
</div>

{% endblock %}

{% block scripts %}
<script>
function toggleDarkMode() {
  document.body.classList.toggle("dark-mode");
  localStorage.setItem("darkMode", document.body.classList.contains("dark-mode"));
  const btn = document.querySelector('.mode-toggle-btn');
  if (btn) {
    btn.textContent = document.body.classList.contains("dark-mode") ? 'â˜€ï¸' : 'ğŸŒ™';
  }
}

window.onload = function() {
  // Modo escuro
  if (localStorage.getItem("darkMode") === "true") {
    document.body.classList.add("dark-mode");
  }

  // BotÃ£o modo escuro
  const btn = document.querySelector('.mode-toggle-btn');
  if (btn) {
    btn.textContent = document.body.classList.contains("dark-mode") ? 'â˜€ï¸' : 'ğŸŒ™';
  }

  // ğŸ”¹ Adiciona imagem de fundo com escurecimento via JS
  const header = document.querySelector('.header-banner');
  if (header) {
    header.style.height = "250px";
    header.style.width = "100%";
    header.style.borderRadius = "15px";
    header.style.display = "flex";
    header.style.flexDirection = "column";
    header.style.justifyContent = "center";
    header.style.alignItems = "center";
    header.style.color = "white";
    header.style.textAlign = "center";
    header.style.position = "relative";
    header.style.overflow = "hidden";

    // Fundo com degradÃª escuro
    header.style.backgroundImage = `
      linear-gradient(rgba(0, 0, 0, 0.55), rgba(0, 0, 0, 0.55)),
      url('{% static 'img/perfilp.png' %}')
    `;
    header.style.backgroundRepeat = "no-repeat";
    header.style.backgroundPosition = "center center";
    header.style.backgroundSize = "cover";
    header.style.boxShadow = "0 4px 12px rgba(0,0,0,0.3)";
  }
};
</script>
{% endblock %}
